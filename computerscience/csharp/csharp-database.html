<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>C# Database CRUD Lesson</title>
  <style>
    body {
      font-family: "Segoe UI", sans-serif;
      margin: 2rem;
      background-color: #f1f1f1;
      color: #333;
    }

    h1, h2 {
      color: #2196f3;
    }

    textarea {
      width: 100%;
      height: 280px;
      font-family: Consolas, monospace;
      background: #111;
      color: #fff;
      padding: 1rem;
      border: none;
      border-radius: 8px;
      resize: vertical;
    }

    button {
      margin-top: 1rem;
      padding: 0.6rem 1.2rem;
      background-color: #2196f3;
      color: white;
      border: none;
      font-size: 1rem;
      border-radius: 6px;
      cursor: pointer;
    }

    button:hover {
      background-color: #0b7dda;
    }

    .output {
      margin-top: 1rem;
      background: #222;
      color: #0f0;
      padding: 1rem;
      border-radius: 8px;
      white-space: pre-wrap;
      min-height: 100px;
    }

    .tip {
      background-color: #e3f2fd;
      padding: 0.5rem 1rem;
      border-left: 5px solid #2196f3;
      margin: 1rem 0;
    }

    table {
      width: 100%;
      margin-top: 1rem;
      border-collapse: collapse;
      background: #fff;
    }

    table, th, td {
      border: 1px solid #ccc;
    }

    th, td {
      padding: 10px;
      text-align: left;
    }

    .crud-buttons {
      margin-top: 1rem;
      display: flex;
      gap: 1rem;
      flex-wrap: wrap;
    }
  </style>
</head>
<body>
  <h1>üìÇ C# Database CRUD Lesson</h1>
  <p>Learn how to perform CRUD (Create, Read, Update, Delete) operations in C# with a SQL Server database using ADO.NET. Below is a simulation to visualize how CRUD works.</p>

  <h2>üìù Example: C# CRUD Code (Simulated)</h2>
  <textarea readonly>
// C# Example: Insert User
string query = "INSERT INTO Users (Name, Age) VALUES (@Name, @Age)";
SqlCommand cmd = new SqlCommand(query, connection);
cmd.Parameters.AddWithValue("@Name", "John Doe");
cmd.Parameters.AddWithValue("@Age", 30);
cmd.ExecuteNonQuery();
  </textarea>

  <div class="crud-buttons">
    <button onclick="simulateInsert()">‚ûï Insert User</button>
    <button onclick="simulateSelect()">üìÑ Select Users</button>
    <button onclick="simulateUpdate()">‚úèÔ∏è Update User</button>
    <button onclick="simulateDelete()">üóëÔ∏è Delete User</button>
  </div>

  <div class="output" id="crudOutput">Output will appear here...</div>

  <h2>üìä Current Database Table (Simulated)</h2>
  <table id="databaseTable">
    <thead>
      <tr>
        <th>ID</th>
        <th>Name</th>
        <th>Age</th>
      </tr>
    </thead>
    <tbody>
      <!-- Simulated Data Rows Here -->
    </tbody>
  </table>

  <script>
    let database = [
      { id: 1, name: 'John Doe', age: 30 },
      { id: 2, name: 'Jane Smith', age: 25 }
    ];
    let nextId = 3;

    function renderTable() {
      const tbody = document.querySelector('#databaseTable tbody');
      tbody.innerHTML = '';
      database.forEach(row => {
        const tr = document.createElement('tr');
        tr.innerHTML = `<td>${row.id}</td><td>${row.name}</td><td>${row.age}</td>`;
        tbody.appendChild(tr);
      });
    }

    function simulateInsert() {
      const newUser = { id: nextId++, name: 'New User', age: 20 + Math.floor(Math.random() * 10) };
      database.push(newUser);
      document.getElementById('crudOutput').innerText = `INSERT INTO Users (Name, Age) VALUES ('${newUser.name}', ${newUser.age})\n\n[Simulated Output]: User inserted successfully!`;
      renderTable();
    }

    function simulateSelect() {
      let output = 'SELECT * FROM Users\n\n[Simulated Output]:\n';
      database.forEach(row => {
        output += `User: ${row.name}, Age: ${row.age}\n`;
      });
      document.getElementById('crudOutput').innerText = output;
    }

    function simulateUpdate() {
      if (database.length > 0) {
        const userToUpdate = database[0];
        userToUpdate.age += 1;
        document.getElementById('crudOutput').innerText = `UPDATE Users SET Age = ${userToUpdate.age} WHERE ID = ${userToUpdate.id}\n\n[Simulated Output]: User updated successfully!`;
        renderTable();
      } else {
        document.getElementById('crudOutput').innerText = 'No users to update.';
      }
    }

    function simulateDelete() {
      if (database.length > 0) {
        const userToDelete = database.pop();
        document.getElementById('crudOutput').innerText = `DELETE FROM Users WHERE ID = ${userToDelete.id}\n\n[Simulated Output]: User deleted successfully!`;
        renderTable();
      } else {
        document.getElementById('crudOutput').innerText = 'No users to delete.';
      }
    }

    renderTable();
  </script>

  <div class="tip">
    üß† <strong>Pro Tip:</strong> Use <code>SqlCommand</code> with parameterized queries to avoid SQL Injection. Always close connections using <code>connection.Close()</code> after operations.
  </div>

  <h2>üß∞ Handling Errors in C#</h2>
  <ul>
    <li><strong>Connection Errors</strong> ‚Äî Ensure the server name, database, and credentials are correct.</li>
    <li><strong>SQL Exceptions</strong> ‚Äî Handle using <code>try-catch</code> blocks to catch errors like constraint violations.</li>
    <li><strong>Timeouts</strong> ‚Äî Adjust <code>SqlCommand.CommandTimeout</code> for long-running queries.</li>
  </ul>
</body>
</html>
